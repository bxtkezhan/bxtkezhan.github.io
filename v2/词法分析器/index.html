<!doctype html><html lang=zh-cn><head><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover"><meta charset=utf-8><meta name=generator content="Hugo 0.121.1 with Arberia theme"><title>bxtkezhan@kk | 词法分析器</title>
<link rel=canonical href=http://bxtkezhan.github.io/v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/><meta name=description content="维基百科介绍：词法分析是计算机科学中将字符序列转换为标记序列的过程。进行词法分析的程序或者函数叫作词法分析器。️"><meta name=author content="kk"><meta name=keywords content="Insert keywords"><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","headline":"词法分析器","datePublished":"2021-03-06T21:26:02+08:00","dateModified":"2021-03-06T21:26:02+08:00","url":"http://bxtkezhan.github.io/v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/","description":"维基百科介绍：词法分析是计算机科学中将字符序列转换为标记序列的过程。进行词法分析的程序或者函数叫作词法分析器。️","keywords":["词法分析","编译","编程","正则表达式","golang","python","c++"],"author":{"@type":"Person","name":"kk"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://bxtkezhan.github.io/v2/"},"publisher":{"@type":"Organization","name":"bxtkezhan@kk","url":"http://bxtkezhan.github.io/v2/"}}</script><link rel=icon href=../v2/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=../v2/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=../v2/favicon/favicon-32x32.png><link rel=apple-touch-icon href=../v2/favicon/apple-touch-icon.png><link rel=mask-icon href=../v2/favicon/safari-pinned-tab.svg><link rel=manifest href=../site.webmanifest><meta name=theme-color content="/v2/"><meta name=msapplication-TileColor content="/v2/"><link rel=stylesheet type=text/css href=../v2/lib/bootstrap/css/bootstrap.min.css><link rel=stylesheet type=text/css href=../v2/lib/lightbox/css/lightbox.css><link rel=stylesheet type=text/css href=../v2/font-awesome-4.7.0/css/font-awesome.min.css><link rel=stylesheet type=text/css href=../v2/gfonts/font.css><link rel=stylesheet href=http://bxtkezhan.github.io/v2/main.min.cd0e89a060caa38dbb22a636944f6f5546d4650fcb33393f71de3295fd988348.css><meta property="og:title" content="词法分析器"><meta property="og:description" content="维基百科介绍：词法分析是计算机科学中将字符序列转换为标记序列的过程。进行词法分析的程序或者函数叫作词法分析器。️"><meta property="og:type" content="article"><meta property="og:url" content="http://bxtkezhan.github.io/v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/"><meta property="og:image" content="http://bxtkezhan.github.io/v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/blog-posts.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-03-06T21:26:02+08:00"><meta property="article:modified_time" content="2021-03-06T21:26:02+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://bxtkezhan.github.io/v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/blog-posts.webp"><meta name=twitter:title content="词法分析器"><meta name=twitter:description content="维基百科介绍：词法分析是计算机科学中将字符序列转换为标记序列的过程。进行词法分析的程序或者函数叫作词法分析器。️"><meta itemprop=name content="词法分析器"><meta itemprop=description content="维基百科介绍：词法分析是计算机科学中将字符序列转换为标记序列的过程。进行词法分析的程序或者函数叫作词法分析器。️"><meta itemprop=datePublished content="2021-03-06T21:26:02+08:00"><meta itemprop=dateModified content="2021-03-06T21:26:02+08:00"><meta itemprop=wordCount content="777"><meta itemprop=image content="http://bxtkezhan.github.io/v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/blog-posts.webp"><meta itemprop=keywords content="词法分析,编译,编程,正则表达式,golang,python,c++,"></head><body><nav class="navbar fixed-top navbar-expand-lg navbar-dark flex-column"><div class="container flex-row"><style>.navbar-brand{color:#fff!important;font-weight:700!important}</style><a class="navbar-brand mr-0 mr-md-2" href=../><img src=../v2/img/arberia-logo.webp width=38 height=38 class="d-inline-block align-top rounded border" loading=lazy alt=brand-logo>
bxtkezhan@kk
</a><button class="navbar-toggler mr-3" type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse navbar-nav-scroll" id=navbarSupportedContent role=navigation aria-label="Main Navigation"><ul class="navbar-nav mr-5 flex-fill"><li class=nav-item><a class=nav-link href=../v2/start-here>Start</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=../v2/ id=navbarDropdownLibrary role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span class="fa fa-th-large" aria-hidden=true></span> View</a><div class=dropdown-menu aria-labelledby=navbarDropdownLibrary><a class=dropdown-item href=../v2/posts/ style=color:#ff7e73;line-height:110%><i class="fa fa-list" aria-hidden=true></i> List View →<br><small class=text-secondary>Post list view of all posts</small>
</a><a class=dropdown-item href=../v2/portfolio/ style=color:#abe5b1;line-height:110%><i class="fa fa-th" aria-hidden=true></i> Grid View →<br><small class=text-secondary>Post grid view of all posts</small>
</a><a class=dropdown-item href=../v2/post-with-sidebar/ style=color:#ffc873;line-height:110%><i class="fa fa-file-text-o" aria-hidden=true></i> Single Post View With Sidebar<br><small class=text-secondary>Single post view with sidebar</small>
</a><a class=dropdown-item href=../v2/post-without-sidebar/ style=color:#ffc873;line-height:110%><i class="fa fa-file-text-o" aria-hidden=true></i> Single Post View Without Sidebar<br><small class=text-secondary>Single post view without sidebar</small>
</a><a class=dropdown-item href=../v2/post-with-cover-image/ style=color:#abe0e5;line-height:110%><i class="fa fa-picture-o" aria-hidden=true></i> Single Post View with Cover<br><small class=text-secondary>Single post view with cover image</small>
</a><a class=dropdown-item href=../v2/video-post-view/ style=color:#abe0e5;line-height:110%><i class="fa fa-film" aria-hidden=true></i> Video Post<br><small class=text-secondary>Single post view of video post</small>
</a><a class="dropdown-item border-top" href=../v2/landingpage/><i class="fa fa-star text-warning" aria-hidden=true></i> Landing Page</a></div></li><li class=nav-item><a class=nav-link href=../v2/contact/>Contact</a></li><li class=nav-item><a class=nav-link href=../v2/about/>About</a></li></ul><div class="collapse navbar-collapse navbar-nav-scroll" id=navbarSupportedContent role=navigation aria-label="Main Navigation"><div class="d-block d-lg-none"><ul class=navbar-nav><li class=nav-item><a class=nav-link href=../search title=Search><span class="d-block d-lg-none"><i class="fa fa-search" aria-hidden=true></i> Search</span><span class="d-none d-lg-block"><i class="fa fa-search" aria-hidden=true></i></span></a></li></ul></div><div class="d-none d-lg-flex align-items-center mr-2 flex-fill"><form class="form-inline ml-0" action=../search method=GET target=_self><a class="js-search-form-submit position-absolute" href=../search title=Search><i class="fa fa-search fa-fw text-muted pl-2" aria-hidden=true></i></a>
<input id=search-by class="search-field form-control form-control-md mr-sm-1 mr-lg-2 w-100" style=padding-left:2rem maxlength=50 data-search-input type=search placeholder=Search aria-label=Search name=q>
<input type=hidden name=_from value=nav></form></div></div></div></nav><div class="container main-content"><div class="row justify-content-center"><div class="col-md-11 col-lg-8 article with-headerlinks"><picture><source media=(min-width:480px) srcset=../v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/blog-posts_hu8cfbf2810aa97c5c54298fa2148ab05b_43252_960x0_resize_q75_h2_box_2.webp type=image/webp><source srcset=../v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/blog-posts_hu8cfbf2810aa97c5c54298fa2148ab05b_43252_480x0_resize_q75_h2_box_2.webp type=image/webp><img loading=lazy class="img-fluid mx-auto d-block rounded mb-4" src=../v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/blog-posts.webp height=1080 width=1920 type=image/webp alt=blog-posts></picture><h1>词法分析器</h1><div class=mb-0><span class=text-muted>by <a class=text-muted href=#author>kk</a>
<span class="ml-2 fa fa-clock-o"></span>
<time>Saturday, March 6, 2021</time>
<span class="ml-2 mr-1 fa fa-comments"></span><a class=text-muted href=#reader-comments>
<span class=disqus-comment-count data-disqus-identifier=http://bxtkezhan.github.io/v2/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E5%99%A8/>0 Comments</span></a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../v2/tags/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90/>词法分析</a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../v2/tags/%E7%BC%96%E8%AF%91/>编译</a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../v2/tags/%E7%BC%96%E7%A8%8B/>编程</a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../v2/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/>正则表达式</a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../v2/tags/golang/>golang</a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../v2/tags/python/>python</a>
<span class="ml-2 fa fa-tags" aria-hidden=true></span>
<a class="badge badge-light text-muted" href=../v2/tags/c++/>c++</a><div class="float-right mt-2"><div id=share-buttons><a class="mr-1 badge badge-twitter text-light mb-1" target=_blank rel=nofollow href="http://twitter.com/intent/tweet?text=%e8%af%8d%e6%b3%95%e5%88%86%e6%9e%90%e5%99%a8&url=http%3a%2f%2fbxtkezhan.github.io%2fv2%2f%25E8%25AF%258D%25E6%25B3%2595%25E5%2588%2586%25E6%259E%2590%25E5%2599%25A8%2f"><i class="mr-1 fa fa-twitter"></i>Tweet</a>
<a target=_blank rel=nofollow href="https://www.facebook.com/share.php?u=http%3a%2f%2fbxtkezhan.github.io%2fv2%2f%25E8%25AF%258D%25E6%25B3%2595%25E5%2588%2586%25E6%259E%2590%25E5%2599%25A8%2f" class="mr-1 badge badge-facebook text-light mb-1"><i class="mr-1 fa fa-facebook-f text-light"></i>Share</a>
<a class="mr-1 badge badge-linkedin text-light mb-1" target=_blank rel=nofollow href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fbxtkezhan.github.io%2fv2%2f%25E8%25AF%258D%25E6%25B3%2595%25E5%2588%2586%25E6%259E%2590%25E5%2599%25A8%2f&title=%e8%af%8d%e6%b3%95%e5%88%86%e6%9e%90%e5%99%a8');"><i class="mr-1 fa fa-twitter"></i>Linkedin</a>
<a target=_blank rel=nofollow href="mailto:?subject=%e8%af%8d%e6%b3%95%e5%88%86%e6%9e%90%e5%99%a8&amp;body=http%3a%2f%2fbxtkezhan.github.io%2fv2%2f%25E8%25AF%258D%25E6%25B3%2595%25E5%2588%2586%25E6%259E%2590%25E5%2599%25A8%2f" class="badge badge-purple text-light mb-1"><i class="mr-1 fa fa-envelope text-light"></i>Email</a></div></div><div class="d-sm-flex flex-row justify-content-between my-3 text-center"></div></span></div><div class=article-body><div class="bg-light sidebar-module sidebar-module-inset" id=toc><p class="h3 mb-2 text-muted">内容的大纲</p><div class=toc><nav id=TableOfContents><ul><li><a href=#go语言实现词法分析器>Go语言实现词法分析器</a></li><li><a href=#go语言代码说明>Go语言代码说明</a><ul><li><ul><li><a href=#引入需要用到的包>引入需要用到的包:</a></li><li><a href=#指定正则表达式和字段类型名称>指定正则表达式和字段类型名称:</a></li><li><a href=#初始化字段匹配规则>初始化字段匹配规则:</a></li><li><a href=#循环匹配字段>循环匹配字段:</a></li><li><a href=#跳过忽略空字符>跳过【忽略】空字符:</a></li><li><a href=#判断是否需要中断循环>判断是否需要中断循环:</a></li><li><a href=#遍历匹配规则尝试匹配>遍历匹配规则尝试匹配:</a></li><li><a href=#根据匹配结果判断后续行为>根据匹配结果判断后续行为:</a></li></ul></li></ul></li><li><a href=#python词法分析器>Python词法分析器</a></li><li><a href=#c实现词法分析器>C++实现词法分析器</a></li></ul></nav></div></div><p><a href=../posts/tutorial_003/>返回教程主页</a></p><p>维基百科介绍：词法分析是计算机科学中将字符序列转换为标记序列的过程。进行词法分析的程序或者函数叫作词法分析器。️</p><p>有如下原始程序代码</p><pre tabindex=0><code>add_result = 1 + 2
</code></pre><p>通过词法分析得到以下结果</p><pre tabindex=0><code>NAME   `add_result` 0,  0
SYMBOL `=`          0, 11
INT    `1`          0, 13
SYMBOL `+`          0, 15
INT    `2`          0, 17
</code></pre><p>整理成表格形式</p><table><thead><tr><th style=text-align:center>标记类型</th><th style=text-align:center>字面值</th><th style=text-align:center>行号</th><th style=text-align:center>列号</th></tr></thead><tbody><tr><td style=text-align:center>NAME</td><td style=text-align:center>add_result</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>SYMBOL</td><td style=text-align:center>=</td><td style=text-align:center>0</td><td style=text-align:center>11</td></tr><tr><td style=text-align:center>INT</td><td style=text-align:center>1</td><td style=text-align:center>0</td><td style=text-align:center>13</td></tr><tr><td style=text-align:center>SYMBOL</td><td style=text-align:center>+</td><td style=text-align:center>0</td><td style=text-align:center>15</td></tr><tr><td style=text-align:center>INT</td><td style=text-align:center>2</td><td style=text-align:center>0</td><td style=text-align:center>17</td></tr></tbody></table><p>我们可以利用Go语言轻松实现可用的词法分析器 😃️</p><hr><h2 id=go语言实现词法分析器>Go语言实现词法分析器</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;regexp&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;unicode/utf8&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>exprs</span> = []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;\\d+&#34;</span>, <span style=color:#e6db74>&#34;[\\p{L}\\d_]+&#34;</span>, <span style=color:#e6db74>&#34;[\\+\\-=]&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>names</span> = []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;INT&#34;</span>,  <span style=color:#e6db74>&#34;NAME&#34;</span>,         <span style=color:#e6db74>&#34;SYMBOL&#34;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>rules</span> <span style=color:#f92672>:=</span> []<span style=color:#f92672>*</span><span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>Regexp</span>{}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>expr</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>exprs</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>rule</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>Compile</span>(<span style=color:#e6db74>&#34;^&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>expr</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>rules</span> = append(<span style=color:#a6e22e>rules</span>, <span style=color:#a6e22e>rule</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>names</span>[<span style=color:#a6e22e>i</span>], <span style=color:#a6e22e>rule</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;--------------------------------&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>code</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>1</span>:] {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>position</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>col</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> <span style=color:#66d9ef>true</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>position</span> &lt; len(<span style=color:#a6e22e>code</span>) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;\t&#39;</span>) {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>position</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>col</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>position</span> <span style=color:#f92672>&gt;=</span> len(<span style=color:#a6e22e>code</span>) {
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>source</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>tokenType</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>rule</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>rules</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>source</span> = <span style=color:#a6e22e>rule</span>.<span style=color:#a6e22e>FindString</span>(<span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>:])
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>source</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>tokenType</span> = <span style=color:#a6e22e>i</span>
</span></span><span style=display:flex><span>					<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>tokenType</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s\t`%s`\t%d\t%d\n&#34;</span>, <span style=color:#a6e22e>names</span>[<span style=color:#a6e22e>tokenType</span>], <span style=color:#a6e22e>source</span>, <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span>)
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>position</span> <span style=color:#f92672>+=</span> len(<span style=color:#a6e22e>source</span>)
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>col</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>utf8</span>.<span style=color:#a6e22e>RuneCountInString</span>(<span style=color:#a6e22e>source</span>)
</span></span><span style=display:flex><span>			} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;error in: %d, %d\n&#34;</span>, <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span>)
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>在命令行中运行测试</p><pre tabindex=0><code>➜ go run lexer.go &#34;数值 = PI + 100&#34;
INT		^\d+
NAME	^[\p{L}\d_]+
SYMBOL	^[\+-=]
--------------------------------
NAME	`数值`	0	0
SYMBOL	`=`	    0	3
NAME	`PI`	0	5
SYMBOL	`+`	    0	8
INT	    `100`	0	10
</code></pre><h2 id=go语言代码说明>Go语言代码说明</h2><h4 id=引入需要用到的包>引入需要用到的包:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;regexp&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;unicode/utf8&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><ul><li>fmt 用于打印输出</li><li>regexp 正则表达式</li><li>unicode/utf8 统计utf8的符文数量</li><li>os 获取用户输入</li></ul><h4 id=指定正则表达式和字段类型名称>指定正则表达式和字段类型名称:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>exprs</span> = []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;\\d+&#34;</span>, <span style=color:#e6db74>&#34;[\\p{L}\\d_]+&#34;</span>, <span style=color:#e6db74>&#34;[\\+\\-=]&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>names</span> = []<span style=color:#66d9ef>string</span>{<span style=color:#e6db74>&#34;INT&#34;</span>,  <span style=color:#e6db74>&#34;NAME&#34;</span>,         <span style=color:#e6db74>&#34;SYMBOL&#34;</span>}
</span></span></code></pre></div><p>创建两个字符串数组分别用于存储正则表达式与对应的字段类型名称。</p><h4 id=初始化字段匹配规则>初始化字段匹配规则:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>rules</span> <span style=color:#f92672>:=</span> []<span style=color:#f92672>*</span><span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>Regexp</span>{}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>expr</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>exprs</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>rule</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>regexp</span>.<span style=color:#a6e22e>Compile</span>(<span style=color:#e6db74>&#34;^&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>expr</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>rules</span> = append(<span style=color:#a6e22e>rules</span>, <span style=color:#a6e22e>rule</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>names</span>[<span style=color:#a6e22e>i</span>], <span style=color:#a6e22e>rule</span>)
</span></span><span style=display:flex><span>	}
</span></span></code></pre></div><p>需要注意的是必须为每一个正则表达式头前插入<code>^</code>用来确保匹配的字符串包括最左边的一个字符，避免“跳跃匹配”。</p><h4 id=循环匹配字段>循环匹配字段:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>code</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>1</span>:] {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>position</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>col</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> <span style=color:#66d9ef>true</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>position</span> &lt; len(<span style=color:#a6e22e>code</span>) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;\t&#39;</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>position</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>col</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>position</span> <span style=color:#f92672>&gt;=</span> len(<span style=color:#a6e22e>code</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>source</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>tokenType</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>rule</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>rules</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>source</span> = <span style=color:#a6e22e>rule</span>.<span style=color:#a6e22e>FindString</span>(<span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>:])
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>source</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>tokenType</span> = <span style=color:#a6e22e>i</span>
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>tokenType</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s\t`%s`\t%d\t%d\n&#34;</span>, <span style=color:#a6e22e>names</span>[<span style=color:#a6e22e>tokenType</span>], <span style=color:#a6e22e>source</span>, <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span>)
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>position</span> <span style=color:#f92672>+=</span> len(<span style=color:#a6e22e>source</span>)
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>col</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>utf8</span>.<span style=color:#a6e22e>RuneCountInString</span>(<span style=color:#a6e22e>source</span>)
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;error in: %d, %d\n&#34;</span>, <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>使用遍历<code>os.Args[1:]</code>的方法将用户输入的每一个参数作为一行代码进行词法分析。</p><h4 id=跳过忽略空字符>跳过【忽略】空字符:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>position</span> &lt; len(<span style=color:#a6e22e>code</span>) <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;\t&#39;</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>position</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>col</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>因为我们的正则表达式必须匹配最左边的一个字符所以需要跳过一些常常没有意义的空字符。</p><h4 id=判断是否需要中断循环>判断是否需要中断循环:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>position</span> <span style=color:#f92672>&gt;=</span> len(<span style=color:#a6e22e>code</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=遍历匹配规则尝试匹配>遍历匹配规则尝试匹配:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>source</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tokenType</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>rule</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>rules</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>source</span> = <span style=color:#a6e22e>rule</span>.<span style=color:#a6e22e>FindString</span>(<span style=color:#a6e22e>code</span>[<span style=color:#a6e22e>position</span>:])
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>source</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>tokenType</span> = <span style=color:#a6e22e>i</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>循环遍历设定的规则进行匹配，如果成功则将下标设定为<code>tokenType</code>的值，如果始终没有匹配则<code>tokenType</code>默认<code>-1</code>。</p><h4 id=根据匹配结果判断后续行为>根据匹配结果判断后续行为:</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>tokenType</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;%s\t`%s`\t%d\t%d\n&#34;</span>, <span style=color:#a6e22e>names</span>[<span style=color:#a6e22e>tokenType</span>], <span style=color:#a6e22e>source</span>, <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>position</span> <span style=color:#f92672>+=</span> len(<span style=color:#a6e22e>source</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>col</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>utf8</span>.<span style=color:#a6e22e>RuneCountInString</span>(<span style=color:#a6e22e>source</span>)
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;error in: %d, %d\n&#34;</span>, <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>如果<code>tokenType</code>不为<code>-1</code>，则匹配成功，将打印字段名称，字面量，行列信息，并且设置<code>position</code>使之跳过当前字段，需要注意下一个字段起始的列号<code>col</code>的增量需要使用utf8的符文计数方法获得，否则遇到一些unicode/utf8编码将无法得到正确指向。</p><p>Python使用者也可以轻松的实现 😁️</p><hr><h2 id=python词法分析器>Python词法分析器</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exprs <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>d+&#39;</span>, <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>w+&#39;</span>, <span style=color:#e6db74>&#39;[</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>+</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>-=]&#39;</span>]
</span></span><span style=display:flex><span>names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;INT&#39;</span>,  <span style=color:#e6db74>&#39;NAME&#39;</span>, <span style=color:#e6db74>&#39;SYMBOL&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    rules <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i, expr <span style=color:#f92672>in</span> enumerate(exprs):
</span></span><span style=display:flex><span>        rules<span style=color:#f92672>.</span>append(re<span style=color:#f92672>.</span>compile(<span style=color:#e6db74>&#39;^&#39;</span> <span style=color:#f92672>+</span> expr))
</span></span><span style=display:flex><span>        print(names[i], rules[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>pattern)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;-&#39;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>32</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row, code <span style=color:#f92672>in</span> enumerate(sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>:]):
</span></span><span style=display:flex><span>        position <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> position <span style=color:#f92672>&lt;</span> len(code) <span style=color:#f92672>and</span> (code[position] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>or</span> code[position] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#39;</span>):
</span></span><span style=display:flex><span>                position <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> position <span style=color:#f92672>&gt;=</span> len(code):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            source <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>            tokenType <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> i, rule <span style=color:#f92672>in</span> enumerate(rules):
</span></span><span style=display:flex><span>                result <span style=color:#f92672>=</span> rule<span style=color:#f92672>.</span>findall(code[position:])
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> len(result) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                    source <span style=color:#f92672>=</span> result[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>                    tokenType <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> tokenType <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>names[tokenType]<span style=color:#e6db74>}</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>`</span><span style=color:#e6db74>{</span>source<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>{</span>row<span style=color:#e6db74>}</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>{</span>position<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>                position <span style=color:#f92672>+=</span> len(source)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;error in </span><span style=color:#e6db74>{</span>row<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>position<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>作为补充内容这里也提供C++方案 😆️</p><hr><h2 id=c实现词法分析器>C++实现词法分析器</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;locale&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;regex&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;vector&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;codecvt&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>wstring<span style=color:#f92672>&gt;</span> exprs{<span style=color:#e6db74>L</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>d+&#34;</span>, <span style=color:#e6db74>L</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>w+&#34;</span>, <span style=color:#e6db74>L</span><span style=color:#e6db74>&#34;[</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>+</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>-=]&#34;</span>};
</span></span><span style=display:flex><span>std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>string<span style=color:#f92672>&gt;</span> names{<span style=color:#e6db74>&#34;INT&#34;</span>,  <span style=color:#e6db74>&#34;NAME&#34;</span>, <span style=color:#e6db74>&#34;SYMBOL&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>int</span> argc, <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>argv[]) {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>locale old;
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>locale<span style=color:#f92672>::</span>global(std<span style=color:#f92672>::</span>locale(<span style=color:#e6db74>&#34;en_US.UTF-8&#34;</span>));
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>wstring_convert<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>codecvt_utf8<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>wchar_t</span><span style=color:#f92672>&gt;&gt;</span> codecvt_utf8;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>std<span style=color:#f92672>::</span>wregex<span style=color:#f92672>&gt;</span> rules;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, count <span style=color:#f92672>=</span> exprs.size(); i <span style=color:#f92672>&lt;</span> count; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>        rules.push_back(std<span style=color:#f92672>::</span>wregex(<span style=color:#e6db74>L</span><span style=color:#e6db74>&#34;^&#34;</span> <span style=color:#f92672>+</span> exprs[i]));
</span></span><span style=display:flex><span>        printf(<span style=color:#e6db74>&#34;%s ^%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, names[i].c_str(), codecvt_utf8.to_bytes(exprs[i]).c_str());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    printf(<span style=color:#e6db74>&#34;--------------------------------</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> row <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; row <span style=color:#f92672>&lt;</span> argc <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#f92672>++</span>row) {
</span></span><span style=display:flex><span>        std<span style=color:#f92672>::</span>wstring code <span style=color:#f92672>=</span> codecvt_utf8.from_bytes(argv[row <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        size_t position <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (true) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> (position <span style=color:#f92672>&lt;</span> code.size() <span style=color:#f92672>&amp;&amp;</span> (code[position] <span style=color:#f92672>==</span> <span style=color:#e6db74>L</span><span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>||</span> code[position] <span style=color:#f92672>==</span> <span style=color:#e6db74>L</span><span style=color:#e6db74>&#39;\t&#39;</span>))
</span></span><span style=display:flex><span>                position <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (position <span style=color:#f92672>&gt;=</span> code.size())
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>auto</span> subcode <span style=color:#f92672>=</span> code.substr(position);
</span></span><span style=display:flex><span>            std<span style=color:#f92672>::</span>wsmatch match;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> tokenType <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, count <span style=color:#f92672>=</span> rules.size(); i <span style=color:#f92672>&lt;</span> count; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (std<span style=color:#f92672>::</span>regex_search(subcode, match, rules[i])) {
</span></span><span style=display:flex><span>                    tokenType <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (tokenType <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>auto</span> source <span style=color:#f92672>=</span> match.str(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>                printf(<span style=color:#e6db74>&#34;%s</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>`%s`</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>%d</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>%ld</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>                    names[tokenType].c_str(), codecvt_utf8.to_bytes(source).c_str(), row, position);
</span></span><span style=display:flex><span>                position <span style=color:#f92672>+=</span> source.size();
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                printf(<span style=color:#e6db74>&#34;error in: %d, %ld</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, row, position);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>locale<span style=color:#f92672>::</span>global(old);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><a href=../post/002-bklexer/>下篇 使用BKLexer进行词法分析</a></p></div><div class="card mt-3 mb-3 bg-secondary"><div id=mc_embed_signup><form class=card-body action="https://antedoro.us9.list-manage.com/subscribe/post?u=e2a0eb4b92cf215c9b65b90b7&amp;id=14b5b5d5ce" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div id=mc_embed_signup_scroll><p class="h5 text-muted text-center">SUBSCRIBE</p><hr><div class="mc-field-group mb-3"><input type=email name=EMAIL class="form-control form-control-md" placeholder=Email… id=mce-EMAIL></div><div id=mce-responses class=clear><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_e2a0eb4b92cf215c9b65b90b7_14b5b5d5ce tabindex=-1></div><div class=clear><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class="btn btn-primary btn-md btn-block"></div><p class="mb-0 mt-2 small text-muted text-center">🔒 No spam. Unsubscribe any time.</p></div></form></div></div><div class="card mt-3 mb-3" id=author><p class="card-header h3">About <strong>kk</strong></p><div class=card-body><div class="container p-0"><div class=row><div class="col-12 col-md-3 align-self-center"><a href=../about><img loading=lazy src=../img/me.jpg srcset="me.jpg 225w,
/img/me.jpg 450w,
/img/me.jpg 900w" sizes=25vw class="d-none d-md-block rounded-circle img-fluid w-100 mb-0" alt=kk width=900 height=900></a></div><div class="col mt-3"><p><strong>Vincenzo Antedoro</strong> is an engineer who helps those who want to invest in renewables. For the rest he enjoys teaching with the method of <em>learning by doing</em>..</p><a href=../about class=card-link>» More aboutkk</a></div></div></div></div></div></div><aside class="col-md-7 col-lg-4"><div id=author class="card mt-0 mb-4"><p class="card-header h3 text-center bg-light text-uppercase"></p><div class=card-body style="margin:-5px -15px -15px"><div class=container><div class=textwidget><p class="small text-muted" style=text-align:justify><img class="float-left rounded m-1" title=kk src=../img/me.jpg srcset="me.jpg 250w,
/img/me.jpg 450w,
/img/me.jpg 900w" sizes=25vw alt=kk width=72 height=72><strong>Vincenzo Antedoro</strong> is an engineer who helps those who want to invest in renewables. For the rest he enjoys teaching with the method of <em>learning by doing</em>.</p></div><a href=../about/ class="small text-muted mr-1">» More about kk</a></div></div></div><script src=https://apis.google.com/js/platform.js></script><div class=ml-3><div class=g-ytsubscribe data-channelid=UCA0wcDlA8aaix_-BScg8Y-A data-layout=full data-count=default></div></div><div class="card mt-3 mb-3 bg-secondary"><div id=mc_embed_signup><form class=card-body action="https://antedoro.us9.list-manage.com/subscribe/post?u=e2a0eb4b92cf215c9b65b90b7&amp;id=14b5b5d5ce" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div id=mc_embed_signup_scroll><p class="h5 text-muted text-center">SUBSCRIBE</p><hr><div class="mc-field-group mb-3"><input type=email name=EMAIL class="form-control form-control-md" placeholder=Email… id=mce-EMAIL></div><div id=mce-responses class=clear><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_e2a0eb4b92cf215c9b65b90b7_14b5b5d5ce tabindex=-1></div><div class=clear><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class="btn btn-primary btn-md btn-block"></div><p class="mb-0 mt-2 small text-muted text-center">🔒 No spam. Unsubscribe any time.</p></div></form></div></div><div id=recent-posts-widget class="card mt-0 mb-4"><p class="card-header h3 text-center bg-light text-uppercase">Recent Posts</p><div class=card-body style="max-height:86px;border-bottom:1px solid rgba(0,0,0,.125)"><div class=row style=margin-top:-8px><div class="col-3 align-items-start"><a href=../v2/arberia-faqs/ alt=text-post class=text-muted><i class="fa fa-file-text-o fa-3x fa-fw text-center w-100"></i></a></div><div class="col-9 align-items-start" style=margin:-5px><a href=../v2/arberia-faqs/ alt="Arberia FAQs" class="card-text small text-muted w-100" style=line-height:.8><strong>Arberia FAQs</strong></a><br><p class="small text-muted align-items-end w-100"><span class="fa fa-clock-o" aria-hidden=true></span>
<span>Wednesday, July 27, 2022</span></p></div></div></div><div class=card-body style="max-height:86px;border-bottom:1px solid rgba(0,0,0,.125)"><div class=row style=margin-top:-8px><div class="col-3 align-items-start"><a href=../v2/arberia-features/ alt=text-post class=text-muted><i class="fa fa-file-text-o fa-3x fa-fw text-center w-100"></i></a></div><div class="col-9 align-items-start" style=margin:-5px><a href=../v2/arberia-features/ alt="Arberia Features" class="card-text small text-muted w-100" style=line-height:.8><strong>Arberia Features</strong></a><br><p class="small text-muted align-items-end w-100"><span class="fa fa-clock-o" aria-hidden=true></span>
<span>Wednesday, July 27, 2022</span></p></div></div></div><div class=card-body style="max-height:86px;border-bottom:1px solid rgba(0,0,0,.125)"><div class=row style=margin-top:-8px><div class="col-3 align-items-start"><a href=../v2/arberia-installation-update/ alt=text-post class=text-muted><i class="fa fa-file-text-o fa-3x fa-fw text-center w-100"></i></a></div><div class="col-9 align-items-start" style=margin:-5px><a href=../v2/arberia-installation-update/ alt="Arberia Installation | Update" class="card-text small text-muted w-100" style=line-height:.8><strong>Arberia Installation | Update</strong></a><br><p class="small text-muted align-items-end w-100"><span class="fa fa-clock-o" aria-hidden=true></span>
<span>Wednesday, July 27, 2022</span></p></div></div></div><div class=card-body style="max-height:86px;border-bottom:1px solid rgba(0,0,0,.125)"><div class=row style=margin-top:-8px><div class="col-3 align-items-start"><a href=../v2/build-in-shortcodes/ alt=text-post class=text-muted><i class="fa fa-file-text-o fa-3x fa-fw text-center w-100"></i></a></div><div class="col-9 align-items-start" style=margin:-5px><a href=../v2/build-in-shortcodes/ alt="Build in Shortcodes" class="card-text small text-muted w-100" style=line-height:.8><strong>Build in Shortcodes</strong></a><br><p class="small text-muted align-items-end w-100"><span class="fa fa-clock-o" aria-hidden=true></span>
<span>Friday, July 22, 2022</span></p></div></div></div><div class=card-body style="max-height:86px;border-bottom:1px solid rgba(0,0,0,.125)"><div class=row style=margin-top:-8px><div class="col-3 align-items-start"><a href=../v2/video-post-view/ alt="Video Post View" class=text-muted><i class="fa fa-film fa-3x fa-fw text-center w-100"></i></a></div><div class="col-9 align-items-start" style=margin:-5px><a href=../v2/video-post-view/ alt="Video Post View" class="card-text small text-muted w-100" style=line-height:.8><strong>Video Post View</strong></a><br><p class="small text-muted align-items-end w-100"><span class="fa fa-clock-o" aria-hidden=true></span>
<span>Saturday, July 9, 2022</span></p></div></div></div></div><div class="sidebar-module sidebar-module-inset border"><p class=h4><a class=link-unstyled href=../tags>All Tag Topics</a></p><div id=theme-tagcloud style=margin-bottom:10px><a href=../v2/tags/tag1 class="badge badge-light text-muted" role=button style=text-transform:lowercase;padding-right:5px;padding-left:5px>tag1</span></a>
<a href=../v2/tags/tag2 class="badge badge-light text-muted" role=button style=text-transform:lowercase;padding-right:5px;padding-left:5px>tag2</span></a>
<a href=../v2/tags/tag3 class="badge badge-light text-muted" role=button style=text-transform:lowercase;padding-right:5px;padding-left:5px>tag3</span></a>
<a href=../v2/tags/tag4 class="badge badge-light text-muted" role=button style=text-transform:lowercase;padding-right:5px;padding-left:5px>tag4</span></a>
<a href=../v2/tags/tutorial class="badge badge-light text-muted" role=button style=text-transform:lowercase;padding-right:5px;padding-left:5px>tutorial</span></a>
<a href=../v2/tags/intermediate class="badge badge-light text-muted" role=button style=text-transform:lowercase;padding-right:5px;padding-left:5px>intermediate</span></a></div></div><div class="bg-light sidebar-module sidebar-module-inset" id=toc><p class="h3 mb-2 text-muted">内容的大纲</p><div class=toc><nav id=TableOfContents><ul><li><a href=#go语言实现词法分析器>Go语言实现词法分析器</a></li><li><a href=#go语言代码说明>Go语言代码说明</a><ul><li><ul><li><a href=#引入需要用到的包>引入需要用到的包:</a></li><li><a href=#指定正则表达式和字段类型名称>指定正则表达式和字段类型名称:</a></li><li><a href=#初始化字段匹配规则>初始化字段匹配规则:</a></li><li><a href=#循环匹配字段>循环匹配字段:</a></li><li><a href=#跳过忽略空字符>跳过【忽略】空字符:</a></li><li><a href=#判断是否需要中断循环>判断是否需要中断循环:</a></li><li><a href=#遍历匹配规则尝试匹配>遍历匹配规则尝试匹配:</a></li><li><a href=#根据匹配结果判断后续行为>根据匹配结果判断后续行为:</a></li></ul></li></ul></li><li><a href=#python词法分析器>Python词法分析器</a></li><li><a href=#c实现词法分析器>C++实现词法分析器</a></li></ul></nav></div></div></div></aside></div></div><footer class=footer><div class=container><p class="small text-center text-muted w-75 mx-auto">&copy 2012–2023 bxtkezhan@kk&nbsp;⋅
<a href=../v2/policy-privacy>Privacy Policy</a>&nbsp;⋅
<a href=../v2/contact>Contact</a>&nbsp;</div></footer><script type=text/javascript src=../v2/lib/jquery/jquery.js></script><script type=text/javascript src=../v2/lib/popper/popper.js></script><script type=text/javascript src=../v2/lib/bootstrap/js/bootstrap.min.js></script><script type=text/javascript src=../v2/lib/lightbox/js/lightbox.js></script><script>if(typeof GLightbox!="undefined"){var lightbox=GLightbox(),lightboxDescription,lightboxVideo,lightboxInlineIframe;lightbox.on("open",e=>{console.log("lightbox opened")}),lightboxDescription=GLightbox({selector:".glightbox2"}),lightboxVideo=GLightbox({selector:".glightbox3"}),lightboxVideo.on("slide_changed",({prev:e,current:t})=>{console.log("Prev slide",e),console.log("Current slide",t);const{slideIndex:s,slideNode:o,slideConfig:i,player:n}=t;n&&(n.ready||n.on("ready",e=>{}),n.on("play",e=>{console.log("Started play")}),n.on("volumechange",e=>{console.log("Volume change")}),n.on("ended",e=>{console.log("Video ended")}))}),lightboxInlineIframe=GLightbox({selector:".glightbox4"})}</script><script type=text/javascript src=../v2/lib/back-to-top/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:56,backgroundColor:"rgb(255, 82, 82)",textColor:"#fff"})</script></body></html>